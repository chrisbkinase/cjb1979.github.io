<html lang="en">
   <!-- Google Tag Manager -->
   <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5BMBQGD');
   </script>
   <!-- End Google Tag Manager -->
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <meta name="description" content="">
      <meta name="author" content="">
      <title>CJ Boyd</title>
      <!--<link rel="stylesheet" type="text/css" href="/global/custom.css">-->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
      <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/all.js" integrity="sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
      <script src = "https://caza.la/synaptic/scripts/homepage/synaptic.js"></script>
      <script src="/markov/mk.js"></script>
      <script src="multi_class_nn.js"></script>
      
      <!-- check box -->
      
      <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
      <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
      
      <!-- end check box -->

      
      <!-- Bootstrap core CSS
         <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
         -->
      <!-- Custom styles for this template -->
      <link href="/global/simple-sidebar.css" rel="stylesheet">
   </head>
   <body>
      <!-- Google Tag Manager (noscript) -->
      <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5BMBQGD"
         height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
      <!-- End Google Tag Manager (noscript) -->
      <div id="wrapper">
      <!-- Sidebar -->
      <div id="sidebar-wrapper">
         <!-- Loaded in with $().load-->
      </div>
      <!-- /#sidebar-wrapper -->
      <!-- Page Content -->
      <div id="buttonmenu">
         <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">
            <h2>></h2>
         </a>
      </div>
      <main role="main" class="container">
         <div id="page-content-wrapper">
         <div class="jumbotron">
            <div class = "row">
               <div class="container-fluid">
                  <h1>Multi-class classifier with synthesised data</h1>
                  <p>This Markov Chain model takes in real place names, and generates new place names based on the letter patterns within those place names.</p>
                  <p>Fiddle with the input options to generate crazy or realistic place names.</p>
                  
                  <div class = "row justify-content-center">
                   <div class="col-4">
                    <button type=button id="btn_go" class = "btn btn-primary btn-lg btn-block">Start</button>
                   </div>
                  </div> 
                  <p>
                  </p>
                  <div class = "row justify-content-center">
                   <div class="col-4">
                    <div class="progress">
                     <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%">
                      <span class="sr-only"></span>
                     </div>
                    </div>
                   </div>
                  </div>  
                  <p>
                  </p>
                  <div class = "row justify-content-center">
                   <div class="col-4">
                    <button type=button id="btn" class = "btn btn-primary btn-lg btn-block">Test Place Name</button>
                   </div>
                  </div>  
                  </div>
                  </div>
                  <p>
                  </p>
                  <div class = "row">
                     <div class="col" id = "ex1">Japan</div>
                     <div class="col" id = "ex2">UK</div>
                     <div class="col" id = "ex3">China</div>
                     <div class="col" id = "ex4">Germany</div>
                     <div class="col" id = "ex5"> </div>
                     <div class="col" id = "ex6">Total</div>
                  </div>
                  
                  <div class = "row">
                     <samp class="col" id = "op1">--%</samp>
                     <samp class="col" id = "op2">--%</samp>
                     <samp class="col" id = "op3">--%</samp>
                     <samp class="col" id = "op4">--%</samp>
                     <samp class="col" id = "op5"> </samp>
                     <samp class="col" id = "op6">--%</samp>
                  </div>
               </div>
               
              <!--   -->
              <h3>Data Settings</h3>
               Real data:
               <form name="inputcontainer">
               <div class="row">
                  <div class="col">
                     <textarea class= "input col form-control" id="a"> </textarea>
                  </div>
                  <div class="col">
                     <textarea class="input col form-control" id="b"> </textarea>
                  </div>
                  <div class="col">
                     <textarea class="input col form-control" id="c"> </textarea>
                  </div>
                  <div class="col">
                     <textarea class="input col form-control" id="d"> </textarea>
                  </div>
               </div>
                <small id="exp" class="form-text text-muted">
                   This is the real data that is submitted to the Markov Model.  This data is always used in testing the accuracy of the classifier.
                </small>
              </form>
              <p>Use synthesised data?</p>
           <form name="checkcontainer">
             <input type="checkbox" checked data-toggle="toggle" id="synth_check">
             <small id="exp" class="form-text text-muted">
              Use synthesised or real data? If real data is picked, it will be reproduced below without being pushed through the Markov Model.
             </small>
            </form>
            Number Of Samples Input into Markov Model:
               <form name="slidecontainer">
                  <input type="range" min="1" max="100" value="100" class="slider" id="sample_slider" oninput="sample_output_i.value = sample_slider.value">
                  <output name="sample_output_n" id="sample_output_i">100</output>
                   <small id="exp" class="form-text text-muted">
                      How many place name samples the model looks at.  The more samples, the more realistic. Set to 1 for all samples.
                   </small>
               </form>
              Number of place names generated:
               <form name="slidecontainer">
                  <input type="range" min="10" max="1000" value="500" class="slider" id="gen_slider" oninput="gen_output_i.value = gen_slider.value">
                  <output name="gen_output_n" id="gen_output_i">500</output>
                   <small id="exp" class="form-text text-muted">
                      How many place name samples the model generates, that are then fed into the neural network.
                   </small>
               </form>
            
            Synthesised data (using <a href = "/markov/">Markov model</a>):
               <form name="inputcontainer">
               <div class="row">
                  <div class="col">
                     <textarea class= "input col form-control" id="a_s"> </textarea>
                  </div>
                  <div class="col">
                     <textarea class="input col form-control" id="b_s"> </textarea>
                  </div>
                  <div class="col">
                     <textarea class="input col form-control" id="c_s"> </textarea>
                  </div>
                  <div class="col">
                     <textarea class="input col form-control" id="d_s"> </textarea>
                  </div>
               </div>
                <small id="exp" class="form-text text-muted">
                   Pick one or more place name corpuses to enter them into the model.  Or select none for a surprise...
                </small>
              </form>

               <p>
               </p>
               <!--
                  Data from which country:
                  <form action="">
                    <input type="checkbox" name="lang" value="JP" id="lang_JP" checked="checked"> JP<br>
                    <input type="checkbox" name="lang" value="UK" id="lang_UK">UK<br>
                    <input type="checkbox" name="lang" value="CH" id="lang_CH">CH<br>
                    <input type="checkbox" name="lang" value="DE" id="lang_DE">DE<br>
                  </form>
                  -->
            
               <h3>Markov Chain Text Generation Settings</h3>
               <p>
               </p>
               Conservativeness:
               <form name="slidecontainer">
                  <input type="range" min="0" max="150" value="100" class="slider" id="power_slider" oninput="power_output_i.value = power_slider.value">
                  <output name="power_output_n" id="power_output_i">100</output>
                  <small id="exp" class="form-text text-muted">
                     How unlikely it is that the model will pick an uncommon pattern.  The higher the number, the more likely the most common patterns will be followed.
                  </small>
               </form>
               Lookback:
               <form name="slidecontainer">
                  <input type="range" min="1" max="3" value="3" class="slider" id="ngram_slider" oninput="ngram_output_i.value = ngram_slider.value">
                  <output name="ngram_output_n" id="ngram_output_i">3</output>
                   <small id="exp" class="form-text text-muted">
                     How many groups of consecutive letters the model looks at.  The higher the number, the more 'realistic' the place names will look.
                  </small>
               </form>
               <!--    <a href="#menu-toggle" class="btn btn-secondary" id="menu-toggle">Show Menu</a>  -->
              <p></p>

              <h3>Neural Network Settings</h3>
              Epochs:        
               <form name="slidecontainer">
                  <input type="range" min="1" max="20" value="5" class="slider" id="epoch_slider" oninput="epoch_output_i.value = epoch_slider.value">
                  <output name="epoch_output_n" id="epoch_output_i">5</output>
                   <small id="exp" class="form-text text-muted">
                      How many times the nn will loop over the data.  Higher values mean more training, but take longer, with a heap of diminishing returns.
                   </small>
               </form>
            <p>
            </p>
            <p>
               Inspired by <a href = "http://max.marrone.nyc/Markov-Word-Generator/">this</a> great project.  All the code is my own.  More information on Markov chains can be found at <a href = "https://en.wikipedia.org/wiki/Markov_chain">Wikipedia</a>.
            </p>
            </div>

            <!-- /#page-content-wrapper -->
      </main>
      </div>
      <!-- /#wrapper -->
      <script>
         
         $('btn').prop('disabled', true);
         function menu_toggle(e){
             $("#wrapper").toggleClass("toggled");
             if ($("#menu-toggle").text() === ">") {
                $("#menu-toggle").html("<h2><</h2>");
             } else {
                $("#menu-toggle").html("<h2>></h2>");
             }
         }
             
            
         $("#menu-toggle").click(function() {
            menu_toggle();
         });
             
         $(function(){
             $("#a").load("/data/jp.txt", function(){
               $("#b").load("/data/en.txt", function(){
                 $("#c").load("/data/ch.txt", function(){
                   $("#d").load("/data/de.txt", function(){
                      
                      document.getElementById('btn_go').addEventListener('click', wrapper, true);

                      //multi_name_class()
                    });
                 }); 
               });
             });
         });
         
         function wrapper(){
            get_markov_results();
            
            var settings = {
               epochs: 5
              
            };
            multi_name_class();
         }
         
         function copy_data(from_id, to_id, amt){
            if (amt === 1) amt = 1000;
            $(to_id).text(  $(from_id).val().split(" ").slice(0,amt).join(" ") );
         }
         
         
         function get_markov_results(){
           var synth =  $("#synth_check").prop( "checked" );
           var power = parseInt(document.getElementById("power_slider").value) / 100;
           var samples = (parseInt(document.getElementById("sample_slider").value)); 
           var n = parseInt(document.getElementById("ngram_slider").value);
           var examples = parseInt(document.getElementById("gen_slider").value);
           
           if (!synth){
              console.log("copying data directly, no markov");
              copy_data("#a", "#a_s", samples);
              copy_data("#b", "#b_s", samples);
              copy_data("#c", "#c_s", samples);
              copy_data("#d", "#d_s", samples);
              return

           }
            
           let settings = {
                 n,
                 power,
                 samples,
                 examples,
                 as_array: false
           };
                      
           settings.text = $("#a").val();
           $("#a_s").text( markov.get ( settings ));
           settings.text = $("#b").val();
           $("#b_s").text( markov.get ( settings ));
           settings.text = $("#c").val();
           $("#c_s").text( markov.get ( settings ));
           settings.text = $("#d").val();
           $("#d_s").text( markov.get ( settings ));
            
        }
                 
           $(function() {
             $("#sidebar-wrapper").load("/global/sidebar.html");
           });
                 
      </script>
   </body>
</html>
