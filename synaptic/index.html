<!DOCTYPE html>
<html>
  
<head>
  <title>Chris Boyd</title>
  <link rel="stylesheet" type="text/css" href="../global_cjb.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>
</head>


  <div id="header">
    
  </div>
<body>
<script> 
  $(function(){
    $("#header").load("/global/header.html"); 
    });
</script> 
<div class="container">
<main>

<div id="status">Training...</div>

<textarea class='input' id="a">Nagoya Toyohashi Okazaki Ichinomiya Seto Handa Kasugai Toyokawa Tsushima Hekinan Kariya Toyota Anjo Nishio Gamagori Inuyama Tokoname Konan Komaki Inazawa Tokai Obu Chita ChiryuChiryu Owariasahi Takahama Iwakura Toyoake Nisshin Tahara Aisai Kiyosu Shinshiro
  Kitanagoya Yatomi Miyoshi Ama Akita Odate Kazuno Daisen Katagami Kitaakita Oga Yurihonjo Yuzawa Semboku Yokote Nikaho Noshiro Hachinohe Kuroishi Misawa Mutsu Towada Tsugaru Goshogawara Aomori Hirakawa Hirosaki Chiba Choshi Ichikawa Funabashi Tateyama
  Kisarazu Matsudo Noda Mobara Narita Sakura Togane Narashino Kashiwa Katsuura Ichihara Nagareyama Yachiyo Abiko Kamagaya Kimitsu Futtsu Urayasu Yotsukaido Sodegaura Yachimata Inzai Shiroi Tomisato Kamogawa Asahi Isumi Sosa Minamiboso Katori Sanmu Matsuyama
  Niihama Shikokuchuo Seiyo Toon Saijo Ozu Imabari Yawatahama Iyo Uwajima Fukui Tsuruga Obama Ono Katsuyama Sabae Awara Echizen Sakai Fukuoka Kurume Omuta Nogata Tagawa Yanagawa Yame Chikugo Okawa Yukuhashi Buzen Nakama Kitakyushu Ogori Chikushino Kasuga
  Onojo Munakata Dazaifu Koga Fukutsu Ukiha Miyawaka Asakura Iizuka Kama Miyama Itoshima Aizuwakamatsu Fukushima Koriyama Sukagawa SomaSoma Iwaki Tamura Shirakawa Nihonmatsu Minamisoma Date Kitakata Motomiya Gifu Ogaki Takayama Tajimi Seki Nakatsugawa
  Mino Mizunami Hashima Minokamo Toki Kakamigahara Kani Yamagata Mizuho Hida Motosu Gujo Gero Ena Kaizu Maebashi Takasaki Kiryu Isesaki OtaOta Numata Tatebayashi Fujioka Shibukawa Annaka Tomioka Midori Hiroshima Onomichi Kure Fukuyama Mihara Fuchu Miyoshi
  Shobara Otake Takehara Higashihiroshima Hatsukaichi Akitakata Etajima Sapporo Hakodate Otaru Asahikawa Muroran Obihiro Yubari Iwamizawa Abashiri Rumoi Tomakomai Wakkanai Bibai Ashibetsu Ebetsu Akabira Monbetsu Mikasa Nemuro Chitose Takikawa Sunagawa
  Utashinai Fukagawa Furano Noboribetsu Eniwa Date Kitahiroshima Ishikari Shibetsu Kushiro Hokuto Kitami Nayoro Kobe Himeji Amagasaki Akashi Nishinomiya Ashiya Itami Aioi Toyooka Kakogawa AkoAko Takarazuka Miki Takasago Kawanishi Ono Sanda Kasai Sasayama
  Yabu Tamba Minamiawaji Asago Awaji ShisoShiso Nishiwaki Tatsuno Sumoto KatoKato Mito Hitachi Tsuchiura Yuki Ryugasaki Shimotsuma JosoJoso Hitachiota Takahagi Kitaibaraki Toride Ushiku Tsukuba Hitachinaka Kashima Itako Moriya Hitachiomiya Naka Bando
  Inashiki Chikusei Kasumigaura Kamisu Namegata Koga Ishioka Sakuragawa Hokota Kasama Tsukubamirai Omitama Kanazawa Nanao Komatsu Suzu Hakui Kahoku Hakusan Nomi Kaga Wajima Morioka Kamaishi Ofunato Rikuzentakata Kitakami Miyako Hachimantai Ichinoseki
  Tono Hanamaki Ninohe Oshu Kuji Takizawa Takamatsu Marugame Sakaide Zentsuji Sanuki Higashikagawa Mitoyo Kan'onji Kagoshima Kanoya Makurazaki Akune Izumi Ibusuki Minamisatsuma Nishinoomote Tarumizu Satsumasendai Hioki Soo Ichikikushikino Kirishima Shibushi
  Amami Minamikyushu Isa Aira Yokohama Yokosuka Kawasaki Hiratsuka Kamakura Fujisawa Odawara Chigasaki Zushi Sagamihara Miura Hadano Atsugi Yamato Isehara Ebina Zama Minamiashigara Ayase KochiKochi Sukumo Aki Tosashimizu Susaki Tosa Muroto Nankoku Shimanto
  Kami Konan Kumamoto Yatsushiro Hitoyoshi Arao Minamata Tamana Yamaga Kikuchi Uto Kamiamakusa Uki Aso Koshi Amakusa Kyoto Fukuchiyama Maizuru Ayabe Tsu Sendai Ishinomaki Shiogama Shiroishi Natori Kakuda Tagajo Iwanuma Tome Kurihara Higashimatsushima
  Kesennuma Osaki Miyazaki Miyakonojo Nobeoka Nichinan Kobayashi Hyuga Kushima Saito Ebino Matsumoto Okaya Suwa Suzaka Komoro Komagane Omachi Iiyama Iida Chino Shiojiri Nagano Chikuma Tomi Nakano Saku Azumino Ueda Ina Nagasaki Sasebo Shimabara Omura Tsushima
  Iki Goto Isahaya Saikai Hirado Unzen Matsuura Minamishimabara Nara Yamatotakada Yamatokoriyama Tenri Kashihara Sakurai Gojo Gose Ikoma Kashiba Katsuragi Uda Niigata Nagaoka Kashiwazaki Shibata Ojiya Kamo Mitsuke Murakami Myoko Joetsu Sado Agano Uonuma
  Minamiuonuma Itoigawa Tokamachi Sanjo Tainai Gosen Tsubame Oita Beppu Nakatsu Hita Saiki Usuki Tsukumi Taketa Bungotakada Usa Bungo-ono Kitsuki Yufu Kunisaki Okayama Kurashiki Tsuyama Tamano Kasaoka Ibara Soja Takahashi Niimi Bizen Setouchi Akaiwa Maniwa
  Mimasaka Asakuchi Naha Ishigaki Ginowan Urasoe Nago Itoman Okinawa Tomigusuku Uruma Miyakojima Nanjo Osaka Sakai Kishiwada Toyonaka Ikeda Suita Izumiotsu Takatsuki Kaizuka Moriguchi Hirakata Ibaraki Yao Izumisano Tondabayashi Neyagawa Kawachinagano
  Matsubara Daito Izumi Minoh Kashiwara Habikino Kadoma Settsu Takaishi Fujiidera Higashiosaka Sennan Shijonawate Katano Osakasayama Hannan Tosu Imari Kashima Taku Karatsu Ogi Saga Ureshino Takeo Kanzaki Kawagoe Kawaguchi Gyoda Chichibu Tokorozawa Hanno
  Kazo Higashimatsuyama Sayama Hanyu Konosu Ageo Soka Koshigaya Warabi Toda Iruma Asaka Shiki Wako Niiza Okegawa Kuki Kitamoto Yashio Fujimi Misato Hasuda Sakado Satte Tsurugashima Hidaka Yoshikawa Saitama Kumagaya Kasukabe Fujimino Fukaya Honjo OtsuOtsu
  Hikone Omihachiman Kusatsu Moriyama RittoRitto KokaKoka Yasu Konan, Shiga Takashima Higashiomi Maibara Nagahama Matsue Izumo Masuda Yasugi Gotsu Unnan Hamada Oda Shizuoka Hamamatsu Numazu Atami Mishima Fujinomiya ItoIto Shimada Iwata Yaizu Kakegawa
  Fujieda Gotenba Fukuroi Fuji Shimoda Susono Kosai Izu Omaezaki Kikugawa Izunokuni Makinohara Utsunomiya Ashikaga Tochigi Kanuma Oyama Mooka Otawara Yaita Nasushiobara Sano Sakura, Tochigi Nasukarasuyama Shimotsuke Nikko Tokushima Naruto Komatsushima Anan Yoshinogawa Mima Awa Miyoshi
</textarea>
<textarea class='input' id="b">Dinnington South-Benfleet Swanscombe-and-Greenhithe Killamarsh Haverfordwest North-Walsham Grahamston Hemel-Hempstead Newton-Abbot Bellshill Heywood Stonehaven Silloth Aspatria Malpas Millom Wigan Twickenham Alfreton Ambleside Highampton Sleaford Fishguard
  Thirsk West-Bedlington Turriff Craven-Arms Kendal Eyemouth Wroxham Hoylake Southminster Little-Benton Airdrie Birchwood Callander Holt Caerwys Dagenham Lydney Clackmannan Sturminster-Newton Padstow Crowland Southwold Nefyn Long-Eaton Farnworth Whitefield
  Oxford Heswall Bridgend Chapel-en-le-Frith Stonehouse Sittingbourne Henley-on-Thames Swindon Egremont Bonnybridge Darlaston Blaenau-Ffestiniog St-Helens Ryde Barnoldswick Windy-Nook Buckie Louth Shoeburyness Laugharne Sheringham Kidsgrove Chesham Neyland
  Tipton Polegate Swinton Windsor Derry Tenby Coldstream Pateley-Bridge Shotton Bruton Normanton Tonbridge North-Tawton Newton-le-Willows Selsey Craigavon Uppingham Bridgnorth Wombwell Aylesbury Fort-William Sandbach Kenilworth Chickerell Blair-Atholl
  Dawley Frinton-on-Sea Whitworth Market-Weighton Fareham Gourock Garstang Todmorden Bexley Nottingham Limavady Prescot Musselburgh Fordwich Consett Durham Great-Malvern Oldbury Gravesend Ramsey Uttoxeter Braintree Harrogate Southend-on-Sea Kinghorn Kingston-upon-Thames
  Bishop's-Stortford Axminster Llandysul Middleton Thorpe-Bay Swadlincote Redruth Castlewellan Thornaby-on-Tees Tavistock Ashby-de-la-Zouch Wath-upon-Dearne Aviemore Burford Greenisland Lincoln Pitlochry Arbroath Diss Highworth Llanfair-Caereinion Fazeley
  Failsworth Bicester Milngavie Kesgrave Berwick-upon-Tweed Dufftown Warsop Leicester Snodland Wembley Chudleigh Edlington St-Mary-Cray Whitchurch Tottenham Troon Sedgefield Ringwood West-Thurrock Orford Burntisland Great-Brookham Corringham Hawick Wormit
  Lerwick Llanrwst Crediton South-Shields Maghull Newport Ballycastle Tewkesbury Newhaven Yarmouth Brecon Fairford Gratton Kirriemuir Brigg Wiveliscombe West-Mersea Wolsingham Mallaig Banbury Dolgellau Taunton Monifieth Strabane Bradford-on-Avon Beltchingley
  Sedgley Chester Dorchester Dovercourt Cromer Thame Chesterfield Harpenden Bromsgrove Pitsea Portadown Bangor Dingwall Topsham Chorleywood Colwyn-Bay Harrow Crewe Tafarnaubach Newmarket Buckhaven Lee-on-the-Solent Dunwich Swanley Grantham Horsham Frodsham
  Penkridge Biddulph Edmonton Woburn-Sands Caister-on-Sea Mablethorpe-and-Sutton Bungay St-Davids West-Tilbury Steyning Wadebridge Hexham New-Milton Barking Evesham Reepham Linlithgow Alsager Bournemouth Loughton Holland-on-Sea Bromley Bath Lochmaben
  Rushden Livingston Glossop Egham Blaydon-on-tyne Shepton-Mallet Much-Wenlock Stotfold Pontypridd Tain Sheriff-Hill Cardigan Teignmouth Newtown-St-Boswells Portree Bodmin Ivybridge Penwortham Aberdeen Maidstone Ballymena Moreton-in-Marsh Warwick Montgomery
  Potton Bridge-of-Allan Romford Atherstone Salcombe Chichester Carterton Wymondham Romsey Arlesey Hunstanton Ullapool Menai-Bridge Brentwood Horley Hoddesdon Forres Llangefni North-Camp Jedburgh Lambourn Penzance Tickhill Harworth-and-Bircotes Sedbergh
  Bletchley Launceston Amersham Brampton St-Blazey Stalybridge Wednesbury Whitland Prestatyn Rhayader Amlwch Saintfield Bagallit Kinross Broughton Banff-and-Macduff Runcorn Ponteland Borehamwood Maesteg Enniskillen Carnoustie Clay-Cross Duniplace Ipswich
  Newcastle-under-Lyme Poynton-with-Worth Willington Stockton-on-Tees Burnham-on-Sea Rainhill Hadfield Billericay Market-Rasen Shallcross Collydean Newbury Cheadle Basildon Prettlewell Eastington Coupar-Angus Woodley Boroughbridge Newcastle-upon-Tyne
  Fordbridge Ashford Newport-Pagnell Donaghadee Newent Penryn Failsworth Wallasey Pembroke Billingham Birmingham Adlington Fakenham Askern Cheadle Lisnaskea Haltwhistle Queensferry Appleby-in-Westmorland Broadstairs Rosyth Dulverton Wakefield Burgh-le-Marsh
  Llandudno Grimsby Crumlin Bolton Benllech Farnborough Liverpool Lancaster Laurencekirk Bentham Towcester Weymouth Redhill Tynemouth Bedlington Highcliffe Beaminster Redenhall-with-Harleston Cullercoats Fraserburgh Caerphilly Burton-upon-Trent Kirkconnel
  Brighouse Eaglescliffe Smethwick Merthyr-Tydfil Selkirk Talgarth Carlisle Shefford Llangors Falmouth Thornton-Cleveleys Llantwit-Major Carluke Ormskirk Driffield Merville-Garden-Village Leven Poole Raunds Emsworth Rowley-Regis Formby Dunfermline Clun
  Hetton New-Alresford Denbigh Fulbourn King's-Lynn Haslingden Swinton Moxley Hendon Whaley-Bridge Kington Bilston Seaford Cannock Chingford Falkland Finchley Cowdenbeath Hereford St-Columb-Major Tisbury Longton Gatehouse-of-Fleet Crowborough Cleckheaton
  Upton-upon-Severn Hythe Milton-Keynes Stone Staveley Holmfirth Otley North-Berwick Saltburn-by-the-Sea Coseley Longbenton Preesall Castle-Douglas Garnant Halesworth Greater-Willington Crook Ruscote Beverley Ongar Luton Houghton-le-Spring Longtown Tiverton
  Nantwich Sidmouth Paignton Aldershot Bishop's-Castle Crewkerne Cardiff Wickham Northleach Laindon Ludlow Wednesfield Gorseinon Inveraray Maud Ayr Woodbridge Greenhill Ellon Bala Staines-upon-Thames Markinch Silsden Barnsley Swanage Budleigh-Salterton
  Kidderminster Armadale South-Cave Dunoon Conwy Huyton Tredegar Coventry Lisburn Saltcoats Brierley-Hill Poulton-le-Fylde Chipping-Sodbury Stamford Invergordon Batley Fordingbridge Hungerford Sheerness Leiston Nairn Coleraine Holywell Stainforth Rothesay
  Salford Melrose Hayle Netherthorpe Cefnllys Westbury Southampton Whitby Keswick Tullibody Portrush Skelmersdale Beccles Ashington Norton-Radstock Yeadon Beeston Selby Abingdon Barnes Exeter Newburgh Barrhead Deal Newbiggin-by-the-Sea Buntingford Sanquhar
  Clitheroe Preston Portsmouth Mitcheldean Denny Cricklade Torpoint Manningtree Rochford Kelloholm Kingsteignton Kemnay Maryport Winchcombe Portsoy Aberaeron Skipton Wallingford North-Shields Hebden-Royd Ashby-Woulds Knutsford Porthleven Northfleet Sawbridgeworth
  Southwark Eccleshall Dronfield-Woodhouse Dunblane Hatfield Verwood Westcliff-on-Sea Southsea Washington Petersfield Penistone Thurso Linlithgow Dundonald Gornal Fenton Ballencrieff Dundee Newport-on-Tay Blackridge Minchinhampton Ellesmere-Port Caistor
  Hessle Fleetwood Wrexham Bradford Bingham Paisley Ashton-under-Lyne Dronfield Tetbury Earlston Newton-Aycliffe Mossley East-Wemyss Inverbervie Sheffield Gretna Ledbury East-Kilbride Ryton Machynlleth Seaham Meltham Southall Ruthin Bedale Lytham-St-Annes
  East-Grinstead Whitburn Woking Syston Eastleigh Stenhousemuir Crosby Brierfield High-Wycombe Sandy Buckingham Hatfield Mold Caldicot Norton-on-Derwent Robin-Hood's-Bay Cockermouth Porthcawl Portishead Exmouth Par St-Neots North-Berwick Macclesfield
  Tunstall Ebbw-Vale Marlow St-Mawes Langley-Mill Hedon Lutterworth Inverness Nailsworth Ely Pickering Galashiels Low-Fell Dereham Farnham Coal-Pool Clayton-le-Moors Mexborough Christchurch Telscombe Rochdale Innerleithen Llanfairfechan Watford Kilkeel
  Brixham Coalville Wantage Broughton Fowey Bingley Lyndhurst Featherstone Wigton Stocksbridge Tadcaster Stanfield-le-Hope Bedworth Shaw-and-Crompton Gellifor South-Petherton Dukinfield Leek Hawes Modbury Aberystwyth Cotgrave Tyldsley Kingsbridge Llanfyllin
  Charlestown Bishop-Auckland Hadleigh Totnes Stockport Y-Felinheli Corbridge Cockenzie-and-Port-Seton Wood-Green Shipley Ellesmere Letchworth Porthmadog Hinckley
</textarea>
<p>
  <div id="exp">
    <p>
      Test your own words here (no spaces or non a-z characters). Please try random words, names, place names, keyboard mashing etc!
    </p>
  </div>
  <button type=button id="test_btn">Test</button>
  <p>

  </p>

  <div id="rich">
<p><strong>How does it work?</strong><br /> <br /><span style="font-size: 10pt;"> This is a simple neural network binary classifier for text. It distinguishes between the place names of two places/languages.</span> <br /> <br /> <strong>Feature Extraction - Character Vectorisation</strong></p>
<p><span style="font-size: 10pt;">I used two different techniques to vectorise the text.&nbsp; Text itself is not directly usable by a neural network, instead the text is 'vectorised' - turned into a multi-dimensional data type.</span></p>
<p><span style="font-size: 10pt;">E.g. in an alphabet with only five letters, for the word 'bed' we would create 15 (5 for the size of the alphabet x 3 letters in the word), and place a '1' in the second column to indicated the 'B'.</span></p>
<table style="height: 44px;" width="223">
<tbody>
<tr>
<td style="width: 48.8px; text-align: center;"><em>A</em></td>
<td style="width: 48.8px; text-align: center;"><em>B</em></td>
<td style="width: 49.6px; text-align: center;"><em>C</em></td>
<td style="width: 49.6px; text-align: center;"><em>D</em></td>
<td style="width: 49.6px; text-align: center;"><em>E</em></td>
</tr>
<tr>
<td style="width: 48.8px; text-align: center;">0</td>
<td style="width: 48.8px; text-align: center;">1</td>
<td style="width: 49.6px; text-align: center;">0</td>
<td style="width: 49.6px; text-align: center;">0</td>
<td style="width: 49.6px; text-align: center;">0</td>
</tr>
</tbody>
</table>
<p><span style="font-size: 10pt;">Then, we would do the same for the next letter, like so:</span></p>
<table style="height: 37px;" width="224">
<tbody>
<tr style="height: 17px;">
<td style="width: 38.4px; height: 17px; text-align: center;"><em>A</em></td>
<td style="width: 38.4px; height: 17px; text-align: center;"><em>B</em></td>
<td style="width: 38.4px; height: 17px; text-align: center;"><em>C</em></td>
<td style="width: 38.4px; height: 17px; text-align: center;"><em>D</em></td>
<td style="width: 39.2px; height: 17px; text-align: center;"><em>E</em></td>
</tr>
<tr>
<td style="width: 38.4px; text-align: center;">0</td>
<td style="width: 38.4px; text-align: center;">0</td>
<td style="width: 38.4px; text-align: center;">0</td>
<td style="width: 38.4px; text-align: center;">0</td>
<td style="width: 39.2px; text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><span style="font-size: 10pt;">And so on for each letter. This means you get a lot of columns, with the majority of them set to '0'. You may be tempted to think 'why not cut down on columns by representing them as their character position 1 for A, 2 for B, 26 for Z etc?''&nbsp; The reason is that we would be implying some deeper mathematical relationship than actually exists to the algorithm.&nbsp; B isn't double A, and E isn't half of J.</span></p>
<p><span style="font-size: 10pt;">However, this technique generates a lot of data for each word.&nbsp; Is there a way to do better?</span></p>
<p><span style="font-size: 10pt;">Instead of representing each letter individually, we could try to represent the letters in the word.&nbsp; Take the word BABE.</span></p>
<table style="height: 51px; width: 215.667px;">
<tbody>
<tr>
<td style="width: 50px; text-align: center;"><em>A</em></td>
<td style="width: 50px; text-align: center;"><em>B</em></td>
<td style="width: 50px; text-align: center;"><em>C</em></td>
<td style="width: 50px; text-align: center;"><em>D</em></td>
<td style="width: 50px; text-align: center;"><em>E</em></td>
</tr>
<tr>
<td style="width: 50px; text-align: center;">1</td>
<td style="width: 50px; text-align: center;">1</td>
<td style="width: 50px; text-align: center;">0</td>
<td style="width: 50px; text-align: center;">0</td>
<td style="width: 50px; text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><span style="font-size: 10pt;">We could use a '1' to indicate that the word contains the letter.&nbsp; In fact, we can do one better, and count the number of occurences of each letter.&nbsp; This is the second technique I used, 'count vectorisation'.</span></p>
<table style="height: 38px; width: 210.667px;">
<tbody>
<tr>
<td style="width: 50px; text-align: center;"><em>A</em></td>
<td style="width: 50px; text-align: center;"><em>B</em></td>
<td style="width: 50px; text-align: center;"><em>C</em></td>
<td style="width: 50px; text-align: center;"><em>D</em></td>
<td style="width: 50px; text-align: center;"><em>E</em></td>
</tr>
<tr>
<td style="width: 50px; text-align: center;">1</td>
<td style="width: 50px; text-align: center;">2</td>
<td style="width: 50px; text-align: center;">0</td>
<td style="width: 50px; text-align: center;">0</td>
<td style="width: 50px; text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><strong> Feature Extraction - Other features</strong></p>
<p><span style="font-size: 10pt;">I also wanted to extract some of the structure of the words.&nbsp; Using count vectorisation, the words 'able' and 'bale' look identical.&nbsp; I found that using regular expressions, it is possible to get a rough idea of the number of syllables in a word.&nbsp; It's not exact: it may count 'bale' as having two syllables, but it was generally close.&nbsp; The syllable count by itself was not good enough because it did not encode the 'density' of syllables.&nbsp; So the word length divided by syllables works.</span></p>
<p><span style="font-size: 10pt;">Finally, I entered one more feature into the model: is the last letter a vowel, with a binary 1 or 0 as the data.</span></p>
<p><br /> <strong>Neural Network - basics</strong></p>
<p><span style="font-size: 10pt;">I'm not able to describe entirely what a neural network is here.&nbsp;</span></p>
<p><span style="font-size: 10pt;">The basic idea is that data is entered into the network, iteration by iteration.&nbsp; The data 'flows' through the network, where it is combined together and undergoes relatively simple mathematical procedures.&nbsp; The data then pops out the other side, and this is the prediction.&nbsp; The data is input one 'column' by one, so each datapoint (in this case the 26 letters + other features) is entered one by one.</span></p>
<p><span style="font-size: 10pt;">The mathematical processes that happen are based on 'weights' - numbers that are multiplied with the input data.&nbsp; Initially, the weights are as good as random, and the output from the network is random, and not useful.&nbsp; Data is also passed through nonlinear 'activation' functions, so that the network is able to understand nonlinear relationships between the data points.</span></p>
<p><span style="font-size: 10pt;">We can compare the output from the network with the 'label' - the actual classification. We take the difference between the output and the actual value, is go back through the network and change the weights, just a little bit, so that next time the output would be slightly closer to the correct answer.&nbsp; Doing this over a lot of iterations over enough data means that the network gets better at generalising - understanding the relationships in the data that cause it to be labelled one way or the other.</span></p>
<p><strong>Neural Network - setup</strong></p>
<p><span style="font-size: 10pt;">The neural network code comes from synaptic.js.&nbsp; It is a simple network, with a depth of 26 charachters + the other 2 features.&nbsp; There is one hidden layer of the same depth, with a ReLU activation function (or 'squash', as the synaptic API refers to them as).&nbsp; ReLU means 'Rectified Linear Unit' - but just means that values under 0 are set to 0, and values above zero are unchanged.&nbsp; The final layer has one output with the logistic function - necessary for the binary classification.</span><br /> <br /> <strong>Scoring</strong></p>
<p>The network is scored by accuracy at the moment.</p>
  </div>


  <div id="output">
    Results will go here
  </div>


<style>
body {
  background-color: Gainsboro;
  font-family: "Helvetica", Times, serif;
}
.input {
  width: 33%;
  height: 80px;
}
#status {
  color: black;
  font-size: 18px;
  font-family: "Helvetica", Times, serif;
}
#output {
  color: black;
  font-size: 12px;
  font-family: "Helvetica", Times, serif;
}
#exp {
  color: gray;
  font-size: 12px;
  font-family: "Helvetica", Times, serif;
}
</style>

<script src="https://caza.la/synaptic/scripts/homepage/synaptic.js"></script>
<script>
var split_amt = 0.1;
var validation_split = (x, ratio) => {
  //randomise the order of the array, then take the top values off for testing
  var len = x.length;
  var amt = parseInt(ratio * len);
  var i = 0;
  
  function shuffle(array) { // from https://stackoverflow.com/questions/5836833/create-a-array-with-random-values-in-javascript
  var tmp, current, top = array.length;
  if(top) while(--top) {
    current = Math.floor(Math.random() * (top + 1));
    tmp = array[current];
    array[current] = array[top];
    array[top] = tmp;
  }
  return array;
}
x = shuffle(x);
return {
  test: x.slice(0,amt),
  train: x.slice(amt, len)
}
 
}
const {
  Layer,
  Network
} = window.synaptic;
var clean = (text) => {
  text = text.replace(/-/g, '') // remove hyphens
  text = text.replace(/\s\s+/g, ' ');
  return text
}
var parse = (text) => {
  text = clean(text);
  return text.split(" ");
}
function last_char_vowel(word) {
  var char = word.split("").pop();
  return /[aeiou]/.test(char) ? 1 : 0
}
function word_len_syllables(word) {
  function syllable_count(word) {
    if (word.length <= 3) return 1;
    word = word.replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/, '');
    word = word.replace(/^y/, '');
    var syl_match = word.match(/[aeiouy]{1,2}/g);
    return (syl_match === null) ? 0 : syl_match.length
  }
  word = word.toLowerCase();
  var syl = syllable_count(word);
  var len = word.length;
  return syl / len
}
var zeroed_range = (i) => Array(i).fill(0);
function do_nothing(word) {
  return [0]
}
function count_vectorise(word) {
  var chars = word.split("");
  var v = zeroed_range(26);
  chars.forEach(function(x) {
    var i = x.toLowerCase().charCodeAt(0) - 97;
    v[i] += 1;
  });
  return v;
}
var normalise = (str) => {
  str = str.slice(0, name_len)
  for (var i = str.length; i < name_len; i++) str += " ";
  return str;
}
var dummy = (name) => {
  name = normalise(name);
  var chars = name.split("");
  var v = [];
  chars.forEach(function(x) {
    var i = x.toLowerCase().charCodeAt(0) - 97;
    i = i > 26 ? 0 : i;
    var r = zeroed_range(26);
    r[i] = 1;
    v = v.concat(r);
  });
  return v
}
var step = (x) => (x > 0.5) ? 1 : 0;
var predict = (name) => {
  var d;
  if (typeof name === "string") {
    name = clean(name);
    d = prepare([name], feature_extractors).pop();
  } else { // if the vector is already provided...
    d = name;
  }
  var p = nn.activate(d).pop();
  var c = step(p);
  return {
    class: classes[c],
    prediction: p,
    class_int: c
  };
}
var prepare = (a, f) => {
  var _a;
  for (var i = 0; i < f.length; i++) {
    if (typeof _a === "undefined") {
      _a = a.map(f[i]);
    } else {
      var _a_latent = a.map(f[i]);
      _a = join(_a, _a_latent);
    }
  }
  return _a
}
var join = (a, b) => {
  for (var i = 0; i < a.length; i++) a[i].push(b[i]);
  return a;
}
var vectoriser = count_vectorise;
var classes = ['Japan', 'UK'];
var parsed_a = parse(document.getElementById('a').value);
var parsed_b = parse(document.getElementById('b').value);
var a_split = validation_split(parsed_a, 0.1);
var a = a_split.train;
var a_names = a_split.test;
var b_split = validation_split(parsed_b, 0.1);
var b = b_split.train;
var b_names = b_split.test;
var html_status = document.getElementById('status');
document.getElementById('test_btn').addEventListener('click', test_word, true);
var feature_extractors = [
  vectoriser,
  word_len_syllables,
  last_char_vowel
];
var _a = prepare(a, feature_extractors);
var _b = prepare(b, feature_extractors);
var depth = _a[0].length;
var input = new Layer(depth);
var hidden = new Layer(depth);
var output = new Layer(1);
input.set({
  bias: 0.5
});
hidden.set({
  squash: Neuron.squash.ReLU
});
output.set({
  squash: Neuron.squash.LOGISTIC
});
input.project(hidden);
hidden.project(output);
var nn = new Network({
  input: input,
  hidden: [hidden],
  output: output
});
var learningRate = 0.025;
var training_iters = Math.min(_a.length, _b.length) * 3;
train(training_iters);
function train(max_iterations) {
  var i = 0;
  var max = Math.min(_a.length, _b.length)
  function train_iteration() {
    var index = i % max;
    nn.activate(_a[index]);
    nn.propagate(learningRate, [0]);
    nn.activate(_b[index]);
    nn.propagate(learningRate, [1]);
    html_status.innerHTML = "iteration " + i + " of " + max_iterations + " (" +
      ((i / max_iterations) * 100).toFixed(2) + "%)";
    i++;
    if (i < max_iterations) {
      setTimeout(train_iteration, 1);
    } else {
      output_sequence();
    }
  }
  train_iteration();
}
function test_word() {
  var test_text = [...a, ...b];
  function rand_int(min, max) {
    return Math.floor(Math.random() * (max - min + 1) + min);
  }
  var i = rand_int(0, test_text.length);
  var name = prompt("Please enter a word to test", test_text[i]);
  var p = predict(clean(name));
  var str = (name + " > " + p.class + " __ score: " + p.prediction.toFixed(4));
  alert(str);
}
function output_sequence() {
  var html_output = document.getElementById('output');
  var arr = [];
  console.log("______________")
  var total = 0;
  var correct = 0;
  a_names.forEach(function(name) {
    var p = predict(clean(name));
    if (p.class === "Japan") correct++;
    var str = (name + " > " + p.class + " __ score: " + p.prediction.toFixed(4));
    arr.push(str)
    total++;
  });
  b_names.forEach(function(name) {
    var p = predict(clean(name));
    if (p.class === "UK") correct++;
    var str = (name + " > " + p.class + " ___ " + p.prediction.toFixed(4));
    arr.push(str);
    total++;
  });
  var acc_str = "Accuracy: " + ((correct / total) * 100).toFixed(2) + "%. Accuracy determined by the below unseen place names.  'Score' is the nets probability of the name being in class 1 (UK), so a score <0.5 effectively means class 0 (Japan).";
  arr.unshift(acc_str);
  arr = arr.map(x => "<p>" + x + "</p>");
  html_output.innerHTML = arr.join("");
  
  return
  
  var min_jap = {val:0, n:""};
  var max_jap = {val:Infinity, n:""};
  
  var min_uk = {val:Infinity, n: ""};
  var max_uk = {val:0, n: ""};
  
  //j
  for (var i = 0; i < a.length; i++){
    var n = a[i];
    var p = predict(clean(n));
    var g = p.prediction;
    if (g < max_jap.val) {
      max_jap.n = a[i];
      max_jap.val = g;
    }
   if (g > min_jap.val) {
      min_jap.n = a[i];
      min_jap.val = g;
    }
  }
  
  for (var i = 0; i < b.length; i++){
    var n = b[i];
    var p = predict(clean(n));
    var g = p.prediction;
    if (g > max_uk.val) {
      max_uk.n = b[i];
      max_uk.val = g;
    }
   if (g < min_uk.val) {
      min_uk.n = b[i];
      min_uk.val = g;
    }
  }
  
  alert("max jap " + JSON.stringify(max_jap));
  alert("min jap " + JSON.stringify(min_jap));
  alert("max uk " + JSON.stringify(max_uk));
  alert("min uk " + JSON.stringify(min_uk));
}
</script>

</body>
</html>
